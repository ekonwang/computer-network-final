[toc]

# 网络层

## 概述

主要任务是把分组从源端传到目的端，为分组交换网上的不同主机提供通信服务。网络层传输单位是<u>数据报</u>。

### 功能

- 路由选择 （为网络包找路）
- 异构网络互联
- 拥塞控制 

> 拥塞控制与流量控制的区别：
>
> 前者是全局性问题，有两种方式1）开环控制/静态方法 2）闭环控制；
>
> 后者通过调节发送方速度解决。

#### 数据报

##### 几种传输单元名词辨析

网络层可能将报文段分组以满足链路层 MTU 限制。

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/截屏2022-01-03 下午1.28.05.png" style="zoom:25%;" />

**无连接服务** 不事先为分组的传输确定传输路径，每个分组独立确定传输路径，不同分组传输路径可能不同。 

#### 虚电路

虚电路方式将数据报和电路交换方式结合，以发挥二者优点。

虚电路：一条源主机到目的主机类似于电路的路径（逻辑连接），路径上所有节点都要维持这条虚电路的建立，维持一张虚电路表，每一项记录了一个打开的虚电路的信息。

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/截屏2022-01-03 下午1.37.51.png" style="zoom:25%;" />

> 本书描述的虚电路服务略有不同：虚电路号是局部性的而非全局性的，用来唯一地标识某条链路。

## VLAN 虚拟局域网

**三种划分 VLAN 的方法**

- 基于端口：
  - 如果节点移动位置，需要重新配置交换机相应端口的VLAN设置。
  - 连接到交换机的一个端口上所有节点都必须属于同一个 VLAN 中。
- 基于 MAC 地址：
  - 交换机维护了一个MAC地址和对应 VLAN 的表。
  - 表的维护是一项繁琐的工作。
  - 节点的移动无需进行重新配置。
- 基于协议：
  - 根据第三层的协议和第三层地址来判断属于哪一个VLAN。
  - 要求交换机支持第三层的交换。
  - 很灵活但是容易被欺骗。

**VLAN帧 v.s. 传统以太网帧**

帧的字段格式不同

<img src="https://pic.imgdb.cn/item/61da37862ab3f51d91849646.png" style="zoom: 67%;" />



## IP 数据报

### IP 数据报格式

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/截屏2022-01-03 下午9.27.28.png" style="zoom:25%;" />

协议字段举例：

- TCP : 6
- UDP : 17

#### IP 数据报的分片

> 链路上帧的数据部分有一定限制，比如在以太网下的限制是 1500 字节，这个大小被称作 MTU。

IP分组的标识字段就是为了标识同一数据报的各个分片。

- 标志<u>(三位)</u>只有<u>末两位</u>有意义。

**中间位 DF (Don't Fragment)**

DF = 1，禁止分片

DF = 0，允许分片

**最低位 MF(More Fragment)**

MF = 1，后面还有分片

MF = 0，代表最后分片

- 片偏移量的单位是<u>**8字节**</u> （作业题踩坑）

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/IP数据报分片例题.png" style="zoom:25%;" />

#### IP 头部三个长度的总结

总长度字段：1 Byte

片偏移：8 Byte

首部长度：4 Byte

### NAT协议

网络地址转换（Network Address Translation）

在<u>**专用网**</u>连接到<u>**因特网**</u>的路由器上安装NAT软件，安装了NAT软件的路由器叫做NAT路由器，它至少有一个有效的外部全球IP地址。

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/截屏2022-01-04 下午6.37.28.png" style="zoom:25%;" />

> 如同路由表之于路由器。
>
> NAT的关键部分是一个由NAT路由器维护的转换表。

### CIDR 无分类编址

提出变长的子网长度。

#### CIDR 地址块

消除了传统A，B，C 类地址的划分。

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/网络层-CIDR.png" style="zoom:33%;" />

*CIDR记法：IP地址后加上 / ，然后写上网络前缀位数。*

一个例子：$192.199.170.82/27$

#### 构成超网

一种路由聚合的算法。把几个小的子网聚合成一个较大的子网。

本质上是合并前缀域。

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/网络层-构成超网.png" style="zoom:25%;" />

*在以上的例子中，R2的两个相邻子网具有共同前缀 $206.1.0.0/16$，因此在路由表中可以合并网络一和网络二对应的表项。*

> 使用CIDR可能导致查找路由表可能得到好几个匹配结果，这时采用的策略是默认最长匹配。前缀越长，地址块越小，路由越具体。
>
> 为了提高匹配效率，一般使用的底层数据结构是Trie树，查询的复杂度是O(1) （考虑到查询串是定长的32位）。

计算每个子网的最大可分配地址个数：$2^b-2$ 

需要排除掉子网号全0和全1的地址。

### ARP 协议

在链路层传输时需要 MAC地址，对 IP 分组封装成链路帧。

一般而言，MAC地址使用 ARP高速缓存 IP 到 MAC 地址的映射，如果没有储存相应的映射，就采用ARP协议广播查询。

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/网络层-ARP2.png" style="zoom:35%;" />

**广播 ARP 请求分组/响应分组**

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/网络层-广播ARP.png" style="zoom:35%;" />

- 由于在实际网络的链路上传输数据帧时，最终必须使用 MAC 地址。
- ARP协议：完成主机或者路由器IP地址到MAC地址的映射。解决下一跳走哪的问题。被认为是网络层的协议。

ARP协议的4种典型情况：

1. 主机A发送给本网络上的主机B
2. 主机A发给另外一个网络上的主机B
3. 路由器发给本网络的主机A
4. 路由器发送给另一个网络的主机A

### DHCP 协议

动态主机配置协议 DHCP 是应用层协议，使用客户/服务器方式，客户端与服务端通过广播方式进行交互，基于 <u>**UDP**</u> 传输。

DHCP 采用即插即联网的机制，主机可以从服务器动态获取 IP 地址、子网掩码、默认网关、DNS 服务器名称与 IP地址。

#### 基本工作流程

1. 主机广播 DHCP 发现报文
2. DHCP 服务器广播 DHCP 提供报文 （本质上是一个预分配的过程）
3. 主机广播 DHCP 请求报文

4. DHCP 服务器广播 DHCP 确认报文

### ICMP 协议

支持差错（或异常）报告。

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/截屏2022-01-04 下午8.11.33.png" style="zoom:33%;" />

**ICMP 差错报文/ICMP查询报文**

1. 终点不可达
2. 源点抑制，当路由器或者主机由于拥塞而丢弃数据报时，就向源点发送源点抑制报文，使源点知道应当把数据发送速率放慢。
3. TTL = 0
4. 参数问题
5. 改变路由（重定向）

 **不发送ICMP差错报文** 

1. 对于ICMP报文本身不再递归地发送差错报告报文
2. 对于第一个分片之后的数据报片都不发送 ICMP 差错报告报文
3. 对于具有组播地址的数据报都不发送 ICMP 差错报文
4. 对于特殊地址如 localhost 的数据报不发送 ICMP 差错报告报文

#### ICMP 应用

##### Ping 

测试两个主机之间的连通性，使用ICMP 回送请求和回答报文。

##### Traceroute

跟踪一个分组从源点到终点的路径，使用了ICMP时间超过差错报告报文。

### IPv6 与 IPv4 之间的区别

1. 32bit -> 128bit
2. **移除了校验和字段**，优化了每跳的处理时间
3. **移除了可选字段**，变成拓展首部，灵活，由于路由器通常不检查而提高了路由器的处理效率。
4. 支持即插即用，不需要DHCP协议
5. 首部长度必须是8B的整数倍
6. 只能在主机处分片
7. ICMPv6：附加报文类型“分组过大”
8. 支持资源预分配
9. 取消了协议字段，改成了下一步首部字段
10. 取消了总长度字段，该用有效载荷长度字段
11. 取消了服务类型字段

#### IPv6 基本地址类型

- 单播
- 多播
- 任播

#### IP隧道

- 在采用IP协议的网络上任意两个节点之间建立一个虚拟链路。
- 隧道可由管理人员手工配置，也可以通过一个隧道建立协议自动建立。

<img src="https://pic.imgdb.cn/item/61da5aa82ab3f51d919bc9af.png" style="zoom:50%;" />

*本质上就是在中间传输的一段再加上了一层封装，隧道对分组的传输并没有加速的效果。*



#### IPv6 向 IPv4 过渡的策略

##### 双栈协议

双协议栈技术就是在一台设备上同时启用IPv4 和 IPv6 协议栈，以同时能够与 IPv4网络以及 IPv6 网络通信。如果这台设备是一个路由器，那么这台路由器的不同接口上，分配配置 IPv4 和 IPv6 地址，并很有可能分别连接了 IPv4 网络和 IPv6 网络。

如果设备是一台计算机，那么它同时拥有IPv4 地址和 IPv6 地址，并具备同时处理这两个协议地址的功能。

##### 隧道技术

隧道协议将其他协议的数据帧或包重新封装之后然后通过隧道。以实现在不同网络基础设施间通信。

> 从下面的例子可以看出，IPv6的包通过IPv4网络时会被重新封装成IPv4分组，从IPv4 到 IPv6 协议栈是前向兼容的。

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/截屏2022-01-04 下午9.13.07.png" style="zoom:25%;" />

#### 总结

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/截屏2022-01-04 下午9.16.37.png" style="zoom:50%;" />

> 补充：IP分组的路由(转发)过程

<img src="https://pic.imgdb.cn/item/61da775d2ab3f51d91b07951.png" style="zoom:33%;" />

<img src="https://pic.imgdb.cn/item/61da77a82ab3f51d91b0b011.jpg" style="zoom: 33%;" />



## 路由算法与路由协议

- 静态路由算法
- 动态路由算法

> 静态路由由管理员配置，简便、可靠，在负荷稳定、拓扑变化不大的网络中运行效果很好，广泛用于小型商业网络和高度安全性的军用网络。
>
> 路由更新更慢，不适用于大型网络。



<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/截屏2022-01-03 下午1.48.04.png" style="zoom:25%;" />

### 因特网的分层次路由选择协议

**自治系统 AS**：在单一的技术管理下的一组路由器，而这些路由器使用一种 AS 内部的路由选择协议和共同的度量以确定该 AS 内的路由，同时还使用一种 AS 之间的路由协议以确定 AS 之间的路由。

一个AS 内的所有网络都属于一个行政单位管辖，一个自治系统的所有路由器在本自治系统内部都必须联通。

### RIP协议和距离向量算法

RIP 是一种分布式的基于<u>距离向量</u>的路由选择协议，是因特网的协议标准，最大优点是简单。

RIP 协议要求网络中每一个路由器都维护从它自己到其他每一个目的网络的唯一最佳距离记录。

**算法流程**

1. 仅和<u>相邻路由器</u>交换信息。
2. 路由器交换的信息是自己的路由表。
3. 每30秒交换一次路由信息，然后路由器根据新信息更新路由表。若超过180s 没收到邻居路由器的通告，则判定与邻居的连接断开，并更新路由表。

*路由器刚开始工作时，只知道直接连接的网络的距离（即1），接着每一个路由器也只和数目很有限的相邻路由器交换并更新路由信息。*

*经过若干次更新之后，所有路由器最终都会知道到达本自治系统任何一个网络的最短距离和下一条路由器的地址，即“收敛”*。

**具体的路由器更新流程**

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/截屏2022-01-03 下午3.00.55.png" style="zoom:25%;" />

1. 对地址为 X 的相邻路由器发来的 RIP 报文，修改此报文中的所有项目：把下一跳字段中的地址改为 X，并把所有的距离字段+1。
2. 对于修改后的 RIP 报文中每一个表项，进行以下操作：
   1. R1 路由表中若没有 Net3，则把该项目填入 R1 路由表
   2. R1 路由表中若有 Net3，则查看下一跳路由器地址：
      - 若下一跳是 X，则直接更新
      - 否则，只有当原来距离更长才选取该表项并更新。

#### RIP 报文

需要记忆：RIP 是应用层协议，使用传输层的 UDP 协议。

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/截屏2022-01-03 下午3.09.19.png" style="zoom:25%;" />

#### RIP 协议问题

RIP 特点：当网络出现故障时，要经过比较长的时间才能将此消息传送给所有的路由器，“慢收敛”/书上称作<u>**无限计数**</u>问题。

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/截屏2022-01-03 下午3.12.53.png" style="zoom:25%;" />

**水平分割** 这是一种尝试抑制无限计数的方法：如果 A 从 B 学习到距离向量，那么 A 发给 B 的路由表将会过滤掉相关的表项。

**反向抑制的水平分割** 如果A 从 B 学习到了距离向量，那么 A 给 B 的路由表对应表项不是被过滤，而是设置成无穷大，表示目的网络不可达。



<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/网络层-RIP.png" style="zoom:25%;" />

### OSPF协议与链路状态算法

**可靠扩散**

<u>*为什么要可靠扩散？*</u>

顺序号可能重复使用，并且路由器可能崩溃

<u>*方法*</u>

- 扩散LSP时要求ACK
- 收到LSP之后不立即扩散，而是等待一段时间，丢弃这段时间内的重复和过时LSP，减少网络负担。

<u>*更”新“的LSP*</u>

由于顺序号可能复用，因此不能通过直接比较顺序号大小的方式确定。

可以画一个顺序号的圆，对于顺序号$A$, 如果另一个顺序号 $B$ 在圆圈的顺时针半圆范围内，就可以认为$B$ 更**“新”**。

**交换方式**

使用洪泛法向自治系统内所有路由器发送信息，即路由器通过输出端口向所有相邻路由器发送消息，而每一个相邻路由器又再次将此信息发往其所有相邻路由器（广播）。

**交换内容**

发送的信息就是本路由器相邻的所有路由器的链路状态，包括时延带宽等信息。

**多久交换**

只有监测到链路状态变化时，AS 内部才发生一次泛洪交换。最后，一个路由器都能获知整个 AS 的全局路由状态/全局拓扑。

**算法的大致工作流程**

1. 通过 HELLO 问候分组，了解邻居节点的网络地址
2. 设置到它的每个邻居的成本度量 <u>**metric**</u>
3. 构造 DD 数据库描述分组，并向邻站发送自己的链路状态数据库中的所有链路状态项目中的摘要信息。如果DD 分组中的摘要自己都有，则邻站不做处理；如果有缺失的或者有更新的，则发送 <u>**LSR（链路状态请求分组）**</u> 。
4. 收到邻站的 LSR 之后，发送 <u>**LSU（链路状态更新分组）**</u>进行更新。
5. 更新完毕之后，邻站返回一个 <u>**LSAck（链路状态确认分组）**</u> 表示确认收到。

> 只要有一个邻居路由器的状态变化，就会导致泛洪更新。
>
> 更新完毕之后，使用 Dijikstra 算法构造自己到其他节点的最短路径。

#### OSPF 区域

为了使 OSPF 适用更大的网络，每个 AS 分成若干区域，每一个区域都有一个 32 位的区域标识符。区域也不能太大，在一个区域的路由器原则上不超过200个路由器。

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/截屏2022-01-03 下午2.29.45.png" style="zoom:25%;" />

#### OSPF LSA类型

- 第一类LSA

路由器LSA，描述OSPF 区域内路由器旁边的路由情况。

| 目的地 | 花费 |
| ------ | ---- |
| N2     | 3    |
| N3     | 1    |

- 第二类LSA

网络LSA，描述区域内子网 （包括中心的广播网络，不过广播网络到各个邻居路由器的花费为0，邻居路由器到广播网络的花费一般不为0）的链路状态。

| 目的地 | 花费 |
| ------ | ---- |
| R2     | -    |
| R3     | -    |

- 第三类LSA

汇集LSA，区域边界路由器承担汇集本区域内LSA的重任，并将其发送至主干区域。

| 目的地 | 花费 |
| ------ | ---- |
| N1     | 4    |
| N2     | 4    |
| N3     | 1    |
| N4     | 2    |

#### OSPF 分组

可以认为是传输层的报文段，采用 IP 协议传输。 

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/网络层-OSPF 分组.png" style="zoom:25%;" />

#### 评 OSPF

- 每隔30min，要刷新一次数据库中的链路状态。
- 由于一个路由器的链路状态只涉及到与相邻路由器的连通状态，因而与整个互联网的规模并无直接关系。因此<u>网络规模很大时，OSPF表现比距离向量路由RIP好得多。</u> 目前中国骨干网 [chinanet](https://www.ctamericas.com/products-services/internet/chinanet-access/) 采用的 IS-IS 协议和 OSPF 相似。
- OSPF 并不存在坏消息传得慢的问题，它的收敛速度很快。



### 外部网关协议 BGP

BGP 协议交换信息的过程。

BGP 所交换的网络可达性信息就是要到达某个网络所要经过的一系列 AS。当 BGP 发言人相互交换了网络可达性信息之后，各 BGP 发言人就根据所采取的策略从收到的路由信息中找到各 AS 的较好路由。

BGP 发言人交换<u>路径向量</u>的过程：

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/截屏2022-01-03 下午3.25.14.png" style="zoom:25%;" />

#### BGP 协议报文格式

一个 BGP 发言人与其他自治系统的 BGP 发言人要交换路由信息，就要先建立 <u>**TCP**</u> 连接，在此基础上交换 BGP 报文以建立 BGP 会话，利用 BGP 会话交换路由信息。

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/截屏2022-01-03 下午3.30.07.png" style="zoom:25%;" />

##### BGP-4 的四种报文

1. OPEN 报文
2. UPDATE 报文
3. KEEPALIVE 报文
4. NOTIFICATION 报文

### 三种路由算法的比较

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/截屏2022-01-03 下午3.37.22.png" style="zoom:25%;" />



## IP 组播/多播

- 单播
- 广播
- 组播/多播

组播提高了数据的传输效率，发送方只需要发送一个副本，减少了主干网出现拥塞的可能性。

IP组播地址让源设备可以将分组发送给一组设备。属于多播组的设备将被分配一个组播组IP地址（一群共同需求主机的相同标识），这个标识就是D类地址 （224.0.0.0～239.255.255.255）。

> D类地址只能用做分组的目的地址。**源地址总是为单播地址。**

### 组播路由选择协议

以源为根节点的<u>**树状路由**</u>，实现了高效且简单的路由分发。

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/截屏2022-01-04 下午9.31.37.png" style="zoom:33%;" />

组播路由选择协议常使用的三种算法

- 基于链路状态的路由选择
- 基于距离-向量的路由选择
- 协议无关的组播（稀疏/密集）

### 硬件组播地址

组播MAC地址以16进制值01-00-5e开头，余下的6个十六进制位通过IP组播组地址的最后23位转发得到。

TCP/IP 协议使用的以太网多播地址的范围是：

01-00-5e-00-00-00 到 01-00-5e-7f-ff-ff

![img](https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/%E6%88%AA%E5%B1%8F2022-01-04%20%E4%B8%8B%E5%8D%888.47.01.png)

*收到多播数据报的主机把不是本主机要接受的数据报丢弃。*

### IGMP 协议

让局域网的组播路由器知道子网是否还有可以接受组播数据报的主机。

更详细地，IGMP协议让路由器知道本局域网上是否有主机（的进程）*<u>参加或退出</u>*了某个组播组。

IGMP使用IP协议栈传输报文。

1. 某主机要加入组播组时，该主机向组播组的组播地址发送一个 IGMP 报文，声明自己要称为该组的成员。本地组播组路由器收到 IGMP 报文后，要利用组播路由选择协议把这组成员关系发送给因特网上的其他组播路由器。
2. 本地组播路由器周期性地探询局域网上的主机，以便知道这些主机是否还是组播组的成员。只要有一个主机对某个组相应，那么组播路由器就认为这个组是活跃的；<u>如果经过几次探询之后没有一个主机响应</u>，组播路由器就认为本网络没有此组播组的主机，因此就不再把这组的成员关系发送给其他组播路由器。**<u>（软状态）</u>**
3. <u>**（反馈抑制）**</u> 组播路由器周期性地探询，只需要有一个主机回应了，其他主机都不用再回应。主机随机选择 $[0, MaxResp.Time]$ 时间等待再发送Report，如果这段时间内听到有来自其他主机的Report，自己就不再发送了。

> 是不是有点像 CSMA/CA 的先听后说？不过二者有很大不同，CSMA/CA 的机制是为了避免冲突，而IGMP的反馈抑制是为了减少无用Report。



### 总结

<img src="https://cdn.jsdelivr.net/gh/ekonwang/images@master/img/截屏2022-01-04 下午9.33.40.png" style="zoom:25%;" />

## 移动 IP

### 怎么支持主机的移动？（重点）

> 如果你想和老朋友写信，但是朋友经常搬家，为了知道朋友的住址你会怎么做？朋友不一定会每次告知你他搬到什么地方，但他的父母往往知道。你可以和朋友的父母联系，从而知道他目前所在的住址。
>
> 每个移动主机都有一个归属网络，每当它所在的网络发生变更时，都会通知他的归属网络。

- `MH`: 移动主机。
- `HA`: 归属代理，用于标识移动主机。
- `CoA`：转交地址，主机当前位置。
- `FA`：外地代理，部署在外地网络中，为到访的移动主机提供服务。

移动路由：

- `CN`发送到`MH`的分组首先到达 `Home Network`，然后通过 `HA` 递交给<u>隧道</u> (再封装) 到达 `FA`，`FA`通过链路层协议递交给 `MH`。
- `MH`发送给`CN`的分组采用**IP路由**，或者通过隧道到`HA`然后到`CN`。

三角路由：

- 移动主机发给通信节点的分组可以采用 IP 路由沿着最优路径到达通信节点
- 但是反过来通信节点发给移动主机的分组首先达到归属代理，然后通过隧道方式到达外地代理并递交给移动主机。这一步带来了比较大的开销。

<img src="https://pic.imgdb.cn/item/61da7e1f2ab3f51d91b59284.png" style="zoom: 47%;" />

三角路由的解决方案：

- 通信节点在发送分组时首先查询**绑定缓存表**，如果没有则与原来的移动IP一样根据 IP 路由到达归属代理，归属代理通过隧道转发到外地代理并最终到达移动主机。如果绑定缓存表中有相应表项，就通过 IP 隧道将分组传送给外地代理。

- **绑定缓存表如何更新？** 分组到达归属代理时，归属代理会向通信节点发送绑定更新消息给出移动主机的当前位置（转交地址），通信节点相应地更新绑定缓存。
- 当通信节点的绑定缓存即将超时时，通信节点可以发送一个 Binding 请求给归属代理，归属代理发送 Binding Update 消息以将其更新为最新的位置。

平滑切换 (smoth handoff)：

> 当一个主机从一个外地网络移动到新的地址时，那些发送到旧外地代理的分组会丢失，因此引入了一个平滑切换的机制，让移动切换的过程平稳进行（不发生突然的大规模丢包）。

- 移动主机向新外地代理发送的Register请求中包含旧外地代理地址，新外地代理发送 Binding Update 消息给旧外地代理，这样以后那些到旧外地代理的分组会被递交给新的外地代理。
- 与此同时，新外地代理发送 Binding Warning 给归属代理，归属代理更新移动主机的位置信息。同时归属代理发送Binding Update 消息给通信主机，让它更新移动主机的位置。

*由于Binding Update消息可能会丢失，因此发送时可以要求接收方通过回应 Binding ACK来确认。*







